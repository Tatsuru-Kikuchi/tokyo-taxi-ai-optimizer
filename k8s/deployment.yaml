apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: tokyo-taxi-optimizer\n  labels:\n    app: tokyo-taxi-optimizer\n    version: v1.0.0\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: tokyo-taxi-optimizer\n  template:\n    metadata:\n      labels:\n        app: tokyo-taxi-optimizer\n        version: v1.0.0\n    spec:\n      containers:\n      - name: taxi-optimizer\n        image: ghcr.io/tatsuru-kikuchi/tokyo-taxi-ai-optimizer:latest\n        ports:\n        - containerPort: 8000\n        env:\n        - name: ENVIRONMENT\n          value: \"production\"\n        - name: DATABASE_URL\n          valueFrom:\n            secretKeyRef:\n              name: taxi-optimizer-secrets\n              key: database-url\n        - name: REDIS_URL\n          valueFrom:\n            secretKeyRef:\n              name: taxi-optimizer-secrets\n              key: redis-url\n        - name: WEATHER_API_KEY\n          valueFrom:\n            secretKeyRef:\n              name: taxi-optimizer-secrets\n              key: weather-api-key\n        - name: ODPT_API_KEY\n          valueFrom:\n            secretKeyRef:\n              name: taxi-optimizer-secrets\n              key: odpt-api-key\n        resources:\n          requests:\n            memory: \"512Mi\"\n            cpu: \"250m\"\n          limits:\n            memory: \"1Gi\"\n            cpu: \"500m\"\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8000\n          initialDelaySeconds: 30\n          periodSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8000\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 1000\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      imagePullSecrets:\n      - name: ghcr-secret\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: tokyo-taxi-optimizer-service\n  labels:\n    app: tokyo-taxi-optimizer\nspec:\n  selector:\n    app: tokyo-taxi-optimizer\n  ports:\n  - protocol: TCP\n    port: 80\n    targetPort: 8000\n  type: LoadBalancer\n---\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: tokyo-taxi-optimizer-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\n    cert-manager.io/cluster-issuer: \"letsencrypt-prod\"\n    nginx.ingress.kubernetes.io/rate-limit: \"100\"\n    nginx.ingress.kubernetes.io/rate-limit-window: \"1m\"\nspec:\n  tls:\n  - hosts:\n    - api.tokyo-taxi-ai.com\n    secretName: taxi-optimizer-tls\n  rules:\n  - host: api.tokyo-taxi-ai.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: tokyo-taxi-optimizer-service\n            port:\n              number: 80\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: taxi-optimizer-secrets\ntype: Opaque\nstringData:\n  database-url: \"postgresql://user:password@postgres:5432/taxi_optimizer\"\n  redis-url: \"redis://redis:6379\"\n  weather-api-key: \"your-jma-api-key\"\n  odpt-api-key: \"your-odpt-api-key\"\n---\napiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: tokyo-taxi-optimizer-hpa\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: tokyo-taxi-optimizer\n  minReplicas: 3\n  maxReplicas: 10\n  metrics:\n  - type: Resource\n    resource:\n      name: cpu\n      target:\n        type: Utilization\n        averageUtilization: 70\n  - type: Resource\n    resource:\n      name: memory\n      target:\n        type: Utilization\n        averageUtilization: 80\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: taxi-optimizer-config\ndata:\n  app-settings.json: |\n    {\n      \"research_institution\": \"University of Tokyo\",\n      \"faculty\": \"Faculty of Economics\",\n      \"researcher\": \"Tatsuru Kikuchi\",\n      \"productivity_improvement\": \"30.2%\",\n      \"rain_correlation\": \"0.847\",\n      \"api_rate_limits\": {\n        \"weather_api\": 100,\n        \"traffic_api\": 200\n      },\n      \"cache_settings\": {\n        \"weather_cache_duration\": 300,\n        \"traffic_cache_duration\": 60,\n        \"hotspots_cache_duration\": 120\n      },\n      \"monitoring\": {\n        \"health_check_interval\": 30,\n        \"metrics_collection\": true,\n        \"log_level\": \"INFO\"\n      }\n    }\n"